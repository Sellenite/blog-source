---
title: 记一次钉钉鉴权验证过程
date: 2020-07-21 20:06:08
tags:
  - JS
  - 钉钉
---

#### 在使用jsapi中，出现以下错误的原因是：

```javascript
{"errorMessage":"对应企业没有某域名微应用", "errorCode":"3"}
```

- 微应用管理的基础信息，应用首页地址或PC端首页地址必须要和打开的地址匹配，不然就会报上面的错

- 鉴权的时候也必须使用对应的corpId，公司ID一般是不变的，可以写死，在开发者后台的首页就能看到

- 必须由最高管理员授权管理员对应的应用权限，才能进入应用拿到最新的AgentId，AppKey，AppSecret，不然有可能是旧的，就会造成鉴权错误

> 附：移动端调试钉钉详细步骤

- 连续点击版本号6次
- 进入系统和更新菜单，打开开发人员选项
- 在开发者选项中，先把“仅充电模式下允许ADB调试”打开，然后再打开“USB调试”
- 连接USB，选择充电模式，必须是充电模式
- 自动会打开RSA验证菜单，确认
- 下载钉钉android开发版，在开发者后台，工具与资源下载，pc和android都有
- 进入手机dev钉钉版，设置-通用-开发者选项，勾选微应用调试
- 应用稳定性管理增加开发负责人和APPOPS为自己
- 手机连接到电脑，打开chrome，chrome://inspect 开始调试，必须翻墙
- 如果无法翻墙，使用UC Devtools也可以进行inspect，如果UC无法inspcet，考虑进入设置，切换InspectorURI Resource为默认资源
- 这时候无论是微应用还是在里面打开的h5页面，都能够监听调试，查看网络请求或错误信息
- 开发一般会接入vConsole，就是微信开发的移动端调试工具，点击浮窗即可查看信息
